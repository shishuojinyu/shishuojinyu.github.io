<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººæ°”æ’è¡Œæ¦œ - ä¸–è¯´é‡‘è¯­</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- å¼•å…¥GSAPåŠ¨ç”»åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>
    <style>
        /* æ’è¡Œæ¦œé¡µé¢ä¸“ç”¨æ ·å¼ - ä¿®å¤ç‰ˆ */
        :root {
            --gold-color: #FFD700;
            --gold-light: #FFEC8B;
            --gold-dark: #FFA500;
            --silver-color: #C0C0C0;
            --bronze-color: #CD7F32;
            --dark-bg: #0a0a0a;
            --darker-bg: #1a1a2e;
        }
        
        body.rank-page {
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--darker-bg) 50%, #16213e 100%);
            color: #fff;
            font-family: 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        /* è¦†ç›–åŸæœ‰æ ·å¼ */
        .content-page.rank-page {
            background: transparent !important;
        }
        
        /* é‡‘è‰²ç²’å­èƒŒæ™¯ */
        #gold-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        /* ä¸»å†…å®¹åŒº - æ’è¡Œæ¦œä¸“ç”¨ */
        .rank-main-content {
            margin-left: 280px;
            padding: 0;
            min-height: 100vh;
            background: transparent;
            transition: margin-left 0.3s ease;
        }
        
        .rank-main-content.sidebar-collapsed {
            margin-left: 80px;
        }
        
        @media (max-width: 768px) {
            .rank-main-content {
                margin-left: 0;
            }
        }
        
        /* é¡¶éƒ¨æ¨ªå¹… */
        .rank-header {
            text-align: center;
            padding: 60px 20px 40px;
            position: relative;
            overflow: hidden;
            background: radial-gradient(ellipse at center, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
        }
        
        .rank-title {
            font-size: 3.5rem;
            background: linear-gradient(45deg, var(--gold-color), var(--gold-dark), var(--gold-light));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
            animation: titleShine 3s ease-in-out infinite;
        }
        
        @keyframes titleShine {
            0%, 100% { 
                filter: brightness(1) drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
            }
            50% { 
                filter: brightness(1.2) drop-shadow(0 0 20px rgba(255, 215, 0, 0.6));
            }
        }
        
        .rank-subtitle {
            font-size: 1.2rem;
            color: #ccc;
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }
        
        .update-time {
            display: inline-block;
            padding: 10px 25px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            font-size: 1rem;
            color: var(--gold-color);
            backdrop-filter: blur(10px);
            margin-top: 20px;
        }
        
        /* å¯¼èˆªæ ‡ç­¾ */
        .rank-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 0 20px 40px;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .rank-tab {
            padding: 12px 28px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid transparent;
            border-radius: 30px;
            color: #ccc;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-family: inherit;
        }
        
        .rank-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .rank-tab:hover::before {
            left: 100%;
        }
        
        .rank-tab:hover {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.5);
            color: var(--gold-color);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .rank-tab.active {
            background: linear-gradient(45deg, var(--gold-color), var(--gold-dark));
            color: #000;
            font-weight: bold;
            border-color: var(--gold-color);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }
        
        .rank-tab-icon {
            margin-right: 8px;
            font-size: 1.2rem;
        }
        
        /* è‹±é›„èˆå°åŒº */
        .hero-stage {
            padding: 30px 20px 60px;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }
        
        .stage-title {
            text-align: center;
            font-size: 2.2rem;
            margin-bottom: 50px;
            color: var(--gold-color);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            position: relative;
        }
        
        .stage-title::after {
            content: '';
            display: block;
            width: 150px;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--gold-color), transparent);
            margin: 20px auto 30px;
        }
        
        .podium-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 40px;
            min-height: 550px;
            position: relative;
            margin-bottom: 60px;
            padding: 0 20px;
        }
        
        /* é€šç”¨å¥–å°æ ·å¼ */
        .podium {
            position: relative;
            border-radius: 20px 20px 0 0;
            padding: 30px 25px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            transition: all 0.5s ease;
            z-index: 1;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
        }
        
        .podium:hover {
            transform: translateY(-15px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
        }
        
        .rank-badge {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 2;
            border: 3px solid;
        }
        
        .crown-icon {
            position: absolute;
            top: -70px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3.5rem;
            animation: crownFloat 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px gold) 
                    drop-shadow(0 0 20px orange);
            z-index: 3;
        }
        
        @keyframes crownFloat {
            0%, 100% { 
                transform: translateX(-50%) translateY(0) rotate(0deg); 
            }
            50% { 
                transform: translateX(-50%) translateY(-15px) rotate(5deg); 
            }
        }
        
        .person-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            border: 5px solid;
            overflow: hidden;
            position: relative;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .person-name {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .person-title {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 25px;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .person-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .stat-item {
            text-align: center;
            min-width: 80px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .influence-score {
            font-size: 1.8rem;
            color: var(--gold-color);
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            margin: 20px 0;
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .rank-change {
            position: absolute;
            top: 25px;
            right: 25px;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 2;
        }
        
        .rank-up {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.4);
        }
        
        .rank-down {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.4);
        }
        
        .rank-same {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.4);
        }
        
        /* å† å†›æ ·å¼ */
        .podium-first {
            width: 350px;
            height: 450px;
            background: linear-gradient(135deg, var(--gold-color) 0%, var(--gold-dark) 100%);
            order: 2;
            position: relative;
            z-index: 3;
            animation: goldGlow 2s ease-in-out infinite alternate;
            border-color: var(--gold-color);
        }
        
        @keyframes goldGlow {
            0% { 
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.6), 
                          0 25px 50px rgba(0, 0, 0, 0.5); 
            }
            100% { 
                box-shadow: 0 0 70px rgba(255, 215, 0, 0.9), 
                          0 35px 70px rgba(0, 0, 0, 0.7); 
            }
        }
        
        .podium-first .rank-badge {
            background: #000;
            color: var(--gold-color);
            border-color: #000;
        }
        
        .podium-first .person-avatar {
            border-color: #000;
            background: linear-gradient(135deg, #FFF8DC 0%, #FFE4B5 100%);
            color: #000;
        }
        
        .podium-first .person-name {
            color: #000;
        }
        
        .podium-first .person-title {
            background: rgba(0, 0, 0, 0.15);
            color: #000;
        }
        
        .podium-first .stat-value {
            color: #000;
        }
        
        .podium-first .influence-score {
            color: #000;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.15);
            border-color: rgba(0, 0, 0, 0.3);
        }
        
        /* äºšå†›æ ·å¼ */
        .podium-second {
            width: 300px;
            height: 400px;
            background: linear-gradient(135deg, var(--silver-color) 0%, #A9A9A9 100%);
            order: 1;
            z-index: 2;
            border-color: var(--silver-color);
        }
        
        .podium-second .rank-badge {
            background: #333;
            color: var(--silver-color);
            border-color: #333;
        }
        
        .podium-second .person-avatar {
            border-color: #333;
            background: linear-gradient(135deg, #F0F0F0 0%, #D3D3D3 100%);
            color: #333;
        }
        
        .podium-second .person-name {
            color: #fff;
        }
        
        .podium-second .person-title {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .podium-second .stat-value {
            color: #fff;
        }
        
        .podium-second .influence-score {
            color: var(--silver-color);
        }
        
        /* å­£å†›æ ·å¼ */
        .podium-third {
            width: 300px;
            height: 380px;
            background: linear-gradient(135deg, var(--bronze-color) 0%, #8B4513 100%);
            order: 3;
            z-index: 2;
            border-color: var(--bronze-color);
        }
        
        .podium-third .rank-badge {
            background: #5D4037;
            color: var(--bronze-color);
            border-color: #5D4037;
        }
        
        .podium-third .person-avatar {
            border-color: #5D4037;
            background: linear-gradient(135deg, #D2691E 0%, #8B4513 100%);
            color: #fff;
        }
        
        .podium-third .person-name {
            color: #fff;
        }
        
        .podium-third .person-title {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .podium-third .stat-value {
            color: #fff;
        }
        
        .podium-third .influence-score {
            color: var(--bronze-color);
        }
        
        /* ç²¾è‹±æ¦œå•åŒº */
        .elite-rankings {
            max-width: 1300px;
            margin: 0 auto 60px;
            padding: 0 20px;
        }
        
        .elite-title {
            font-size: 2rem;
            margin-bottom: 40px;
            color: var(--gold-color);
            text-align: center;
            position: relative;
        }
        
        .elite-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold-color), transparent);
            margin: 20px auto 30px;
        }
        
        .elite-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .elite-card {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .elite-card:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 215, 0, 0.3);
        }
        
        .elite-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.15), transparent);
            transition: left 0.7s ease;
        }
        
        .elite-card:hover::before {
            left: 100%;
        }
        
        .elite-rank {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--gold-color);
            border: 3px solid rgba(255, 215, 0, 0.3);
        }
        
        .elite-content {
            display: flex;
            align-items: center;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .elite-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            background: rgba(255, 215, 0, 0.15);
            border: 3px solid rgba(255, 215, 0, 0.3);
            flex-shrink: 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .elite-info {
            flex: 1;
        }
        
        .elite-name {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #fff;
        }
        
        .elite-type {
            display: inline-block;
            padding: 5px 15px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            font-size: 0.9rem;
            color: var(--gold-color);
            margin-bottom: 12px;
        }
        
        .elite-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .elite-stat {
            text-align: center;
            padding: 15px 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .elite-stat:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }
        
        .elite-stat-value {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--gold-color);
        }
        
        .elite-stat-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* å†å²æ’åå˜åŒ– */
        .history-section {
            max-width: 1300px;
            margin: 0 auto 80px;
            padding: 0 20px;
        }
        
        .history-title {
            font-size: 2rem;
            margin-bottom: 40px;
            color: var(--gold-color);
            text-align: center;
            position: relative;
        }
        
        .history-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold-color), transparent);
            margin: 20px auto 30px;
        }
        
        .history-chart-container {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 215, 0, 0.1);
            backdrop-filter: blur(10px);
            height: 400px;
        }
        
        /* è¿›åº¦æ¡æ ·å¼ */
        .progress-bars {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .progress-item {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 215, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .progress-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
            transform: translateY(-3px);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .progress-name {
            font-size: 1.4rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .progress-rank {
            color: var(--gold-color);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .progress-bar-bg {
            height: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            margin-bottom: 15px;
        }
        
        .progress-bar-fill {
            height: 100%;
            border-radius: 12px;
            background: linear-gradient(90deg, var(--gold-color), var(--gold-dark));
            position: relative;
            transition: width 2s ease;
            width: 0;
        }
        
        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 3s infinite linear;
        }
        
        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .progress-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .podium-container {
                gap: 30px;
            }
            
            .podium-first {
                width: 320px;
                height: 420px;
            }
            
            .podium-second,
            .podium-third {
                width: 280px;
                height: 380px;
            }
            
            .elite-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
        
        @media (max-width: 992px) {
            .podium-container {
                flex-direction: column;
                align-items: center;
                gap: 60px;
                min-height: auto;
            }
            
            .podium {
                width: 80% !important;
                max-width: 450px;
                height: auto !important;
                min-height: 400px;
            }
            
            .podium-first {
                order: 1;
            }
            
            .podium-second {
                order: 2;
            }
            
            .podium-third {
                order: 3;
            }
        }
        
        @media (max-width: 768px) {
            .rank-main-content {
                margin-left: 0;
            }
            
            .rank-title {
                font-size: 2.5rem;
            }
            
            .rank-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .rank-tab {
                width: 90%;
                max-width: 300px;
            }
            
            .elite-grid {
                grid-template-columns: 1fr;
            }
            
            .podium {
                width: 95% !important;
                padding: 25px 20px;
            }
            
            .person-avatar {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }
            
            .person-name {
                font-size: 1.7rem;
                min-height: 50px;
            }
            
            .history-chart-container {
                padding: 20px;
                height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .rank-title {
                font-size: 2rem;
            }
            
            .stage-title,
            .elite-title,
            .history-title {
                font-size: 1.6rem;
            }
            
            .podium {
                padding: 20px 15px;
            }
            
            .person-stats {
                gap: 15px;
            }
            
            .stat-value {
                font-size: 1.6rem;
            }
            
            .elite-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .progress-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .progress-stats {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        /* èšå…‰ç¯æ•ˆæœ */
        .spotlight {
            position: fixed;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        /* ç¤¼èŠ±æ•ˆæœå®¹å™¨ */
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            overflow: hidden;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 20px;
            opacity: 0;
        }
        
        /* å›åˆ°é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--gold-color), var(--gold-dark));
            border: none;
            border-radius: 50%;
            color: #000;
            font-size: 1.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
            opacity: 0;
            transform: translateY(20px);
            font-weight: bold;
        }
        
        .back-to-top.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .back-to-top:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.6);
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 5px solid rgba(255, 215, 0, 0.3);
            border-top: 5px solid var(--gold-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* æ— æ•°æ®æç¤º */
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
        }
        
        /* æ’ååºå·å¾½ç«  */
        .rank-number {
            font-size: 1.1rem;
            font-weight: bold;
            margin-right: 10px;
            color: var(--gold-color);
        }
    </style>
</head>
<body class="content-page rank-page">
    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>
    
    <!-- é‡‘è‰²ç²’å­èƒŒæ™¯ -->
    <canvas id="gold-particles"></canvas>
    
    <!-- ç¤¼èŠ±æ•ˆæœå®¹å™¨ -->
    <div id="confetti-container"></div>
    
    <!-- èšå…‰ç¯æ•ˆæœ -->
    <div class="spotlight" id="spotlight"></div>
    
    <!-- å·¦ä¾§ä¾§è¾¹æ å®¹å™¨ -->
    <div class="sidebar" id="sidebar">
        <button class="sidebar-toggle" id="sidebar-toggle">â‰¡</button>
        <div class="sidebar-content">
            <div class="sidebar-header">
                <h2 class="sidebar-main-title">ä¸–è¯´é‡‘è¯­</h2>
                <p class="sidebar-sub-title">æ ¡å›­è¯­å½•æ¡£æ¡ˆé¦†</p>
                <hr class="sidebar-divider">
            </div>
            
            <div class="subject-list">
                <!-- è¯­æ–‡ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“– è¯­æ–‡</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="é™ˆç³">é™ˆç³</span>
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="èŒƒå¶æ–Œ">èŒƒå¶æ–Œ</span>
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="éƒ‘å®‡">éƒ‘å®‡</span>
                    </div>
                </div>
                
                <!-- æ•°å­¦ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ”¢ æ•°å­¦</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ•°å­¦" data-teacher="é‡‘å£°">é‡‘å£°</span>
                    </div>
                </div>
                
                <!-- è‹±è¯­ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ—£ï¸ è‹±è¯­</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="è‹±è¯­" data-teacher="å†¯ç§‹äº‘">å†¯ç§‹äº‘</span>
                        <span class="teacher-item" data-subject="è‹±è¯­" data-teacher="èµµæ°¸æ’">èµµæ°¸æ’</span>
                    </div>
                </div>
                
                <!-- ç‰©ç† -->
                <div class="subject-item">
                    <span class="subject-title">âš›ï¸ ç‰©ç†</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="ç‰©ç†" data-teacher="é¢œæœ‰è™¹">é¢œæœ‰è™¹</span>
                    </div>
                </div>
                
                <!-- åŒ–å­¦ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ§ª åŒ–å­¦</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="åŒ–å­¦" data-teacher="ä¸¥å¿—èŠ³">ä¸¥å¿—èŠ³</span>
                        <span class="teacher-item" data-subject="åŒ–å­¦" data-teacher="ç¨‹ä¿æƒ">ç¨‹ä¿æƒ</span>
                    </div>
                </div>
                
                <!-- ç”Ÿç‰© -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ§¬ ç”Ÿç‰©</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="ç”Ÿç‰©" data-teacher="é™ˆå‰ç´">é™ˆå‰ç´</span>
                        <span class="teacher-item" data-subject="ç”Ÿç‰©" data-teacher="å¶æ°¸è">å¶æ°¸è</span>
                    </div>
                </div>
                
                <!-- æ”¿æ²» -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“œ æ”¿æ²»</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ”¿æ²»" data-teacher="å‚…æ•">å‚…æ•</span>
                        <span class="teacher-item" data-subject="æ”¿æ²»" data-teacher="æ—æ ¹">æ—æ ¹</span>
                    </div>
                </div>
                
                <!-- æ•™å®˜è¯­å½• -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ¥ æ•™å®˜è¯­å½•</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ•™å®˜è¯­å½•" data-teacher="æ˜Ÿè¾°">æ˜Ÿè¾°</span>
                    </div>
                </div>
                
                <!-- å­¦ç”Ÿè¯­å½• -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ‘¨â€ğŸ“ å­¦ç”Ÿè¯­å½•</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="å­¦ç”Ÿè¯­å½•" data-teacher="æœªæ•´ç†">å­¦ç”Ÿè¯­å½•</span>
                    </div>
                </div>
                
                <!-- æ•°æ®åˆ†æ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“Š æ•°æ®åˆ†æ</span>
                    <div class="teacher-list">
                        <a href="rank.html" class="teacher-item" data-subject="æ•°æ®åˆ†æ" data-teacher="äººæ°”æ’è¡Œæ¦œ">äººæ°”æ’è¡Œæ¦œğŸ†</a>
                        <a href="summary.html" class="teacher-item" data-subject="æ•°æ®åˆ†æ" data-teacher="ç»Ÿè®¡">ç»Ÿè®¡ğŸ“ˆ</a>
                    </div>
                </div>
                
                <!-- èµ›åšæ¡£æ¡ˆ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ¤– èµ›åšæ¡£æ¡ˆ</span>
                    <div class="teacher-list">
                        <a href="picture.html" class="teacher-item" data-subject="èµ›åšæ¡£æ¡ˆ" data-teacher="å›¾ç‰‡é›†">å›¾ç‰‡é›†</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å³ä¾§å†…å®¹åŒº -->
    <div class="rank-main-content" id="rank-main-content">
        <div class="top-bar">
            <a href="search.html" class="search-btn">
                <span>ğŸ”</span> æœç´¢
            </a>
        </div>

        <!-- æ’è¡Œæ¦œé¡µé¢å†…å®¹ -->
        <div class="rank-content">
            <!-- é¡¶éƒ¨æ¨ªå¹… -->
            <div class="rank-header">
                <h1 class="rank-title">ğŸ† äººæ°”é£äº‘æ¦œ ğŸ†</h1>
                <p class="rank-subtitle">é‡‘å£°é—ªè€€ï¼Œè¯­å½•äº‰é”‹ Â· è£è€€å±äºæ¯ä¸€ä½æ ¡å›­ä¼ å¥‡</p>
                <div class="update-time" id="updateTimeDisplay">æ•°æ®æ›´æ–°äºï¼š2025å¹´12æœˆ28æ—¥11æ—¶06åˆ†00ç§’</div>
            </div>
            
            <!-- å¯¼èˆªæ ‡ç­¾ -->
            <div class="rank-tabs">
                <button class="rank-tab active" data-rank-type="all">
                    <span class="rank-tab-icon">ğŸ”¥</span> ç»¼åˆå½±å“åŠ›æ¦œ
                </button>
                <button class="rank-tab" data-rank-type="teachers">
                    <span class="rank-tab-icon">ğŸ‘¨â€ğŸ«</span> æ•™å¸ˆç²¾è‹±æ¦œ
                </button>
                <button class="rank-tab" data-rank-type="students">
                    <span class="rank-tab-icon">ğŸ‘¨â€ğŸ“</span> å­¦ç”Ÿæ–°æ˜Ÿæ¦œ
                </button>
                <button class="rank-tab" data-rank-type="quotes">
                    <span class="rank-tab-icon">ğŸ’¬</span> è¯­å½•æ•°é‡æ¦œ
                </button>
                <button class="rank-tab" data-rank-type="mentioned">
                    <span class="rank-tab-icon">ğŸ‘ï¸</span> è¢«æåŠæ¦œ
                </button>
                <button class="rank-tab" data-rank-type="progress">
                    <span class="rank-tab-icon">ğŸ“ˆ</span> è¿›æ­¥æœ€å¿«æ¦œ
                </button>
            </div>
            
            <!-- è‹±é›„èˆå°åŒº -->
            <div class="hero-stage">
                <h2 class="stage-title">ğŸ… è£è€€æ®¿å ‚ Â· å‰ä¸‰ç”²</h2>
                
                <div class="podium-container" id="podium-container">
                    <!-- å‰ä¸‰ååŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- ç²¾è‹±æ¦œå•åŒº -->
            <div class="elite-rankings">
                <h2 class="elite-title">ğŸ–ï¸ ç²¾è‹±æ¦œå• Â· ç¬¬4-20å</h2>
                <div class="elite-grid" id="elite-grid">
                    <!-- ç²¾è‹±æ¦œå•åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- å†å²æ’åå˜åŒ– -->
            <div class="history-section">
                <h2 class="history-title">ğŸ“Š å†å²æ’åå˜åŒ–è¶‹åŠ¿</h2>
                
                <div class="history-chart-container">
                    <canvas id="historyChart"></canvas>
                </div>
                
                <div class="progress-bars" id="progress-bars">
                    <!-- è¿›åº¦æ¡åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="back-to-top">â†‘</button>

    <script>
        // ============================================
        // æ•°æ®é…ç½®åŒº - ä½¿ç”¨çœŸå®æ•°æ®
        // ============================================
        
        // è¯­å½•æ”¶å½•æˆªæ­¢æ—¶é—´
        const UPDATE_TIME = "2025å¹´12æœˆ28æ—¥11æ—¶06åˆ†00ç§’";
        
        // æ•™å¸ˆçœŸå®æ•°æ®
        const TEACHER_DATA = {
            "é™ˆç³": [341, 25],
            "èŒƒå¶æ–Œ": [19, 8],
            "éƒ‘å®‡": [30, 12],
            "é‡‘å£°": [870, 185],
            "å†¯ç§‹äº‘": [42, 18],
            "èµµæ°¸æ’": [27, 10],
            "é¢œæœ‰è™¹": [322, 68],
            "ä¸¥å¿—èŠ³": [97, 22],
            "ç¨‹ä¿æƒ": [20, 9],
            "é™ˆå‰ç´": [102, 30],
            "å¶æ°¸è": [21, 6],
            "å‚…æ•": [26, 15],
            "æ—æ ¹": [104, 32],
            "æ˜Ÿè¾°": [29, 12]
        };
        
        // å­¦ç”ŸçœŸå®æ•°æ®ï¼ˆæ¥è‡ªä¹‹å‰çš„åˆ†æï¼‰
        const STUDENT_DATA = {
            "è°¢æ˜Šè¾°": [0, 2],
            "é‚±æµ©å®¸": [1, 2],
            "éŸ©é‡‘æˆ": [0, 1],
            "éƒ‘æ™¯ä¸¥": [0, 5],
            "éƒ‘ä¹é¼": [0, 4],
            "ç‹æµ©å®‡": [0, 0],
            "é»„èŠ·è£³": [0, 0],
            "åˆ˜æ¢“æ¥·": [2, 39],
            "é™ˆæ—ä½³": [5, 18],
            "å€ªæ¥·æ¥ ": [0, 2],
            "é™ˆæµ©å¤©": [0, 3],
            "å¼ å­æ‰¬": [1, 16],
            "å´æ˜Šå¤©": [0, 5],
            "å¼ çš“": [3, 12],
            "æ±ªåƒé›…": [0, 0],
            "é»„æœµå„¿": [0, 0],
            "å´æ³½æ›¦": [0, 2],
            "æ—æ›¾ç«¤": [0, 3],
            "é™ˆæ˜“èˆª": [0, 4],
            "æ—è£æ˜•": [0, 2],
            "æ—ç­ é“­": [0, 1],
            "å¶ä¸€å¸†": [1, 7],
            "é»„æ¥·æ°": [0, 2],
            "æ¸©é™åª›": [0, 1],
            "å­™æ¾œè": [0, 0],
            "é»„å®¶è€€": [13, 64],
            "å¶å¯è¿": [0, 6],
            "å…°å˜‰æ¶µ": [0, 3],
            "å•å¥•é“®": [6, 8],
            "å¸¸å‡¯": [0, 14],
            "æ—å³»æº": [0, 0],
            "ç« çš“æ™¨": [0, 2],
            "é™ˆæ å½¤": [0, 0],
            "é™ˆä½³é‘«": [0, 2],
            "å´å…†å…ƒ": [0, 0],
            "ä½•å†¬æ˜±": [0, 2],
            "èµ–ç¥‰ç¥º": [0, 2],
            "æ—é–è½©": [0, 0],
            "è”¡è¾¾ç¤¼": [2, 6],
            "å¶å­å°§": [0, 1],
            "è”¡é“ æ³½": [0, 6],
            "é™†åº­é”´": [0, 0],
            "æ—å˜‰è±ª": [1, 0],
            "é™ˆç¿æ°": [0, 3],
            "æ±Ÿæ™ºæˆ": [0, 1],
            "ææµ©ä¸€": [0, 1],
            "æå¥¥": [0, 2],
            "åˆ˜é›¨çª": [0, 2],
            "åˆ˜è¾°ç¿": [0, 0],
            "æ—äº¦è½²": [0, 5],
            "å·«å¤æœµ": [0, 0],
            "å‘¨å–„è¿›": [0, 1],
            "æ—é“ å¢¨": [2, 13],
            "ä¼åšé”´": [0, 3]
        };
        
        // å½±å“åŠ›æŒ‡æ•°æƒé‡
        const WEIGHTS = {
            quoteWeight: 1.0,
            mentionedWeight: 0.7
        };
        
        // æ•™å¸ˆç§‘ç›®ä¿¡æ¯
        const TEACHER_SUBJECTS = {
            "é™ˆç³": "è¯­æ–‡",
            "èŒƒå¶æ–Œ": "è¯­æ–‡",
            "éƒ‘å®‡": "è¯­æ–‡",
            "é‡‘å£°": "æ•°å­¦",
            "å†¯ç§‹äº‘": "è‹±è¯­",
            "èµµæ°¸æ’": "è‹±è¯­",
            "é¢œæœ‰è™¹": "ç‰©ç†",
            "ä¸¥å¿—èŠ³": "åŒ–å­¦",
            "ç¨‹ä¿æƒ": "åŒ–å­¦",
            "é™ˆå‰ç´": "ç”Ÿç‰©",
            "å¶æ°¸è": "ç”Ÿç‰©",
            "å‚…æ•": "æ”¿æ²»",
            "æ—æ ¹": "æ”¿æ²»",
            "æ˜Ÿè¾°": "æ•™å®˜è¯­å½•"
        };
        
        // ============================================
        // æ•°æ®å‡†å¤‡å’Œè®¡ç®—å‡½æ•°
        // ============================================
        
        // ç”Ÿæˆå®Œæ•´æ•°æ®é›†åˆ
        function generateRankData() {
            const allData = [];
            
            // æ·»åŠ æ•™å¸ˆæ•°æ®
            Object.keys(TEACHER_DATA).forEach((teacherName, index) => {
                const [quoteCount, mentionedCount] = TEACHER_DATA[teacherName];
                const influenceScore = calculateInfluenceScore(quoteCount, mentionedCount);
                const subject = TEACHER_SUBJECTS[teacherName] || "æœªçŸ¥ç§‘ç›®";
                
                allData.push({
                    id: `T${String(index + 1).padStart(2, '0')}`,
                    originalId: index + 1,
                    name: teacherName,
                    displayName: `${subject}-${teacherName}`,
                    type: "teacher",
                    subject: subject,
                    quoteCount: quoteCount,
                    mentionedCount: mentionedCount,
                    influenceScore: influenceScore,
                    title: getTitleByScore(influenceScore, "teacher")
                });
            });
            
            // æ·»åŠ å­¦ç”Ÿæ•°æ®
            let studentIndex = 1;
            Object.keys(STUDENT_DATA).forEach((studentName) => {
                const studentStats = STUDENT_DATA[studentName] || [0, 0];
                const [quoteCount, mentionedCount] = studentStats;
                const influenceScore = calculateInfluenceScore(quoteCount, mentionedCount);
                const seatNumber = String(studentIndex).padStart(2, '0');
                
                allData.push({
                    id: seatNumber,
                    originalId: studentIndex + 100, // å­¦ç”ŸIDä»100å¼€å§‹
                    name: studentName,
                    displayName: `${seatNumber}-${studentName}`,
                    type: "student",
                    subject: "1ç­",
                    quoteCount: quoteCount,
                    mentionedCount: mentionedCount,
                    influenceScore: influenceScore,
                    title: getTitleByScore(influenceScore, "student")
                });
                
                studentIndex++;
            });
            
            return allData;
        }
        
        // è®¡ç®—å½±å“åŠ›æŒ‡æ•°
        function calculateInfluenceScore(quoteCount, mentionedCount) {
            return (quoteCount * WEIGHTS.quoteWeight) + (mentionedCount * WEIGHTS.mentionedWeight);
        }
        
        // æ ¹æ®åˆ†æ•°è·å–ç§°å·
        function getTitleByScore(score, type) {
            if (type === "teacher") {
                if (score >= 200) return "ä¼ å¥‡å®—å¸ˆ";
                if (score >= 100) return "é‡‘ç‰Œè®²å¸ˆ";
                if (score >= 50) return "äººæ°”æ•™å¸ˆ";
                if (score >= 20) return "æ½œåŠ›æ•™å¸ˆ";
                return "æ–°æ™‹æ•™å¸ˆ";
            } else {
                if (score >= 50) return "æ ¡å›­ä¹‹æ˜Ÿ";
                if (score >= 20) return "äººæ°”æ–°æ˜Ÿ";
                if (score >= 10) return "æ´»è·ƒåˆ†å­";
                if (score >= 5) return "æ½œåŠ›æ–°äºº";
                return "è§‚å¯Ÿå­¦å‘˜";
            }
        }
        
        // è·å–å¤´åƒé¢œè‰²
        function getAvatarColor(name) {
            const colors = [
                "#FFD700", "#FFA500", "#FF6347", "#FF69B4", "#9370DB",
                "#00CED1", "#32CD32", "#1E90FF", "#FF4500", "#DA70D6"
            ];
            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                hash = name.charCodeAt(i) + ((hash << 5) - hash);
            }
            return colors[Math.abs(hash) % colors.length];
        }
        
        // è·å–åå­—é¦–å­—æ¯
        function getInitials(name) {
            // å¦‚æœæ˜¯ä¸­æ–‡åå­—ï¼Œå–å‰ä¸¤ä¸ªå­—ç¬¦
            if (/[\u4e00-\u9fa5]/.test(name)) {
                return name.length >= 2 ? name.substring(0, 2) : name;
            }
            // å¦‚æœæ˜¯è‹±æ–‡åå­—ï¼Œå–é¦–å­—æ¯
            return name.substring(0, 1).toUpperCase();
        }
        
        // ============================================
        // å¯è§†åŒ–ç‰¹æ•ˆ
        // ============================================
        
        // é‡‘è‰²ç²’å­èƒŒæ™¯
        function initParticleBackground() {
            const canvas = document.getElementById('gold-particles');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let particles = [];
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            function createParticles() {
                particles = [];
                const particleCount = Math.min(100, Math.floor(window.innerWidth * window.innerHeight / 15000));
                
                for (let i = 0; i < particleCount; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        size: Math.random() * 3 + 1,
                        speedX: (Math.random() - 0.5) * 0.5,
                        speedY: (Math.random() - 0.5) * 0.5,
                        color: `rgba(255, ${Math.floor(215 + Math.random() * 40)}, 0, ${Math.random() * 0.3 + 0.1})`
                    });
                }
            }
            
            function animateParticles() {
                if (!canvas || !ctx) return;
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach(p => {
                    p.x += p.speedX;
                    p.y += p.speedY;
                    
                    // è¾¹ç•Œæ£€æŸ¥
                    if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;
                    if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;
                    
                    // ç»˜åˆ¶ç²’å­
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fillStyle = p.color;
                    ctx.fill();
                    
                    // ç»˜åˆ¶å…‰æ™•
                    const gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 3);
                    gradient.addColorStop(0, p.color.replace(')', ', 0.3)').replace('rgb', 'rgba'));
                    gradient.addColorStop(1, 'transparent');
                    
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size * 3, 0, Math.PI * 2);
                    ctx.fillStyle = gradient;
                    ctx.fill();
                });
                
                requestAnimationFrame(animateParticles);
            }
            
            // åˆå§‹åŒ–
            resizeCanvas();
            createParticles();
            animateParticles();
            
            // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç½®
            window.addEventListener('resize', () => {
                resizeCanvas();
                createParticles();
            });
        }
        
        // ç¤¼èŠ±ç‰¹æ•ˆ
        function createConfetti() {
            const container = document.getElementById('confetti-container');
            if (!container) return;
            
            const colors = ['#FFD700', '#FFA500', '#FFEC8B', '#FF6347', '#32CD32', '#1E90FF'];
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 15 + 10 + 'px';
                
                container.appendChild(confetti);
                
                // åŠ¨ç”»
                if (typeof gsap !== 'undefined') {
                    gsap.to(confetti, {
                        y: window.innerHeight + 100,
                        x: Math.random() * 200 - 100,
                        rotation: Math.random() * 360,
                        opacity: 1,
                        duration: Math.random() * 3 + 2,
                        ease: "power1.out",
                        onComplete: () => {
                            confetti.remove();
                        }
                    });
                    
                    gsap.to(confetti, {
                        opacity: 0,
                        duration: 0.5,
                        delay: Math.random() * 2 + 1
                    });
                } else {
                    // å¦‚æœGSAPæœªåŠ è½½ï¼Œä½¿ç”¨åŸç”ŸåŠ¨ç”»
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }
            }
        }
        
        // èšå…‰ç¯æ•ˆæœ
        function initSpotlight() {
            const spotlight = document.getElementById('spotlight');
            if (!spotlight) return;
            
            document.addEventListener('mousemove', (e) => {
                if (typeof gsap !== 'undefined') {
                    gsap.to(spotlight, {
                        x: e.clientX - 150,
                        y: e.clientY - 150,
                        opacity: 0.3,
                        duration: 0.2
                    });
                } else {
                    spotlight.style.left = (e.clientX - 150) + 'px';
                    spotlight.style.top = (e.clientY - 150) + 'px';
                    spotlight.style.opacity = '0.3';
                }
            });
            
            // é¼ æ ‡ç¦»å¼€é¡µé¢æ—¶éšè—
            document.addEventListener('mouseleave', () => {
                if (typeof gsap !== 'undefined') {
                    gsap.to(spotlight, {
                        opacity: 0,
                        duration: 0.3
                    });
                } else {
                    spotlight.style.opacity = '0';
                }
            });
            
            // é¼ æ ‡è¿›å…¥é¡µé¢æ—¶æ˜¾ç¤º
            document.addEventListener('mouseenter', () => {
                if (typeof gsap !== 'undefined') {
                    gsap.to(spotlight, {
                        opacity: 0.3,
                        duration: 0.3
                    });
                } else {
                    spotlight.style.opacity = '0.3';
                }
            });
        }
        
        // ============================================
        // æ’åæ¸²æŸ“å‡½æ•°
        // ============================================
        
        let allRankData = [];
        let currentRankType = 'all';
        let historyChart = null;
        
        // æ¨¡æ‹Ÿå†å²æ’åæ•°æ®
        function generateHistoryData(names) {
            const history = {};
            names.forEach(name => {
                // ç”Ÿæˆè¿‡å»7æœŸçš„æ’åæ•°æ®ï¼ˆ1-30åä¹‹é—´éšæœºï¼Œä½†è¶‹åŠ¿åº”è¯¥åˆç†ï¼‰
                const pastRanks = [];
                let currentRank = Math.floor(Math.random() * 20) + 1;
                
                for (let i = 0; i < 7; i++) {
                    // æ¨¡æ‹Ÿæ’åå˜åŒ–ï¼ˆ-3åˆ°3ä¹‹é—´ï¼‰
                    const change = Math.floor(Math.random() * 7) - 3;
                    currentRank = Math.max(1, Math.min(30, currentRank + change));
                    pastRanks.push(currentRank);
                }
                history[name] = pastRanks;
            });
            return history;
        }
        
        // æ¸²æŸ“å‰ä¸‰åå¥–å°
        function renderPodium(topThree) {
            const container = document.getElementById('podium-container');
            if (!container) return;
            
            if (!topThree || topThree.length === 0) {
                container.innerHTML = '<div class="no-data">æš‚æ— å‰ä¸‰åæ•°æ®</div>';
                return;
            }
            
            let podiumHTML = '';
            
            // ç¡®ä¿è‡³å°‘æœ‰3ä¸ªä½ç½®ï¼Œå¦‚æœä¸å¤Ÿå°±ç”¨ç©ºä½å¡«å……
            for (let i = 0; i < 3; i++) {
                const person = topThree[i] || null;
                const rank = i + 1;
                
                let podiumClass = '';
                if (rank === 1) podiumClass = 'podium-first';
                else if (rank === 2) podiumClass = 'podium-second';
                else podiumClass = 'podium-third';
                
                if (person) {
                    const rankChange = getRankChange(person.name);
                    const changeClass = rankChange > 0 ? 'rank-up' : rankChange < 0 ? 'rank-down' : 'rank-same';
                    const changeIcon = rankChange > 0 ? 'â†‘' : rankChange < 0 ? 'â†“' : '';
                    const changeText = rankChange !== 0 ? Math.abs(rankChange) : '';
                    
                    podiumHTML += `
                        <div class="podium ${podiumClass}">
                            ${rank === 1 ? '<div class="crown-icon">ğŸ‘‘</div>' : ''}
                            <div class="rank-badge">${rank}</div>
                            
                            ${rankChange !== 0 ? `
                                <div class="rank-change ${changeClass}">
                                    ${changeIcon}${changeText}
                                </div>
                            ` : ''}
                            
                            <div class="person-avatar" style="border-color: ${getAvatarColor(person.name)}; background: ${getAvatarColor(person.name)}22; color: ${getAvatarColor(person.name)};">
                                ${getInitials(person.name)}
                            </div>
                            
                            <h3 class="person-name">${person.name}</h3>
                            <div class="person-title">${person.title}</div>
                            
                            <div class="person-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${person.quoteCount}</div>
                                    <div class="stat-label">è¯­å½•æ•°</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${person.mentionedCount}</div>
                                    <div class="stat-label">è¢«æåŠ</div>
                                </div>
                            </div>
                            
                            <div class="influence-score">
                                å½±å“åŠ›: ${person.influenceScore.toFixed(1)}
                            </div>
                            
                            <div class="person-type" style="margin-top: 15px; font-size: 0.9rem; color: rgba(255,255,255,0.7);">
                                ${person.type === 'teacher' ? 'ğŸ‘¨â€ğŸ« æ•™å¸ˆ Â· ' + person.subject : 'ğŸ‘¨â€ğŸ“ å­¦ç”Ÿ Â· ' + person.subject}
                            </div>
                        </div>
                    `;
                } else {
                    // ç©ºä½
                    podiumHTML += `
                        <div class="podium ${podiumClass}" style="opacity: 0.5;">
                            <div class="rank-badge">${rank}</div>
                            <div class="person-avatar" style="border-color: #666; background: #333; color: #666;">
                                ?
                            </div>
                            <h3 class="person-name">è™šä½ä»¥å¾…</h3>
                            <div class="person-title">ç­‰å¾…ä¸Šæ¦œ</div>
                            <div style="margin-top: 40px; color: rgba(255,255,255,0.5);">
                                æš‚æ— æ•°æ®
                            </div>
                        </div>
                    `;
                }
            }
            
            container.innerHTML = podiumHTML;
            
            // æ·»åŠ å…¥åœºåŠ¨ç”»
            if (typeof gsap !== 'undefined') {
                gsap.from('.podium', {
                    y: 100,
                    opacity: 0,
                    duration: 1,
                    stagger: 0.2,
                    ease: "back.out(1.7)"
                });
            }
        }
        
        // æ¸²æŸ“ç²¾è‹±æ¦œå•ï¼ˆ4-20åï¼‰
        function renderEliteRankings(rankings) {
            const container = document.getElementById('elite-grid');
            if (!container) return;
            
            const eliteData = rankings.slice(3, 20); // å–4-20å
            
            if (!eliteData || eliteData.length === 0) {
                container.innerHTML = '<div class="no-data">æš‚æ— ç²¾è‹±æ¦œå•æ•°æ®</div>';
                return;
            }
            
            let eliteHTML = '';
            
            eliteData.forEach((person, index) => {
                const rank = index + 4; // ä»ç¬¬4åå¼€å§‹
                const rankChange = getRankChange(person.name);
                const changeClass = rankChange > 0 ? 'rank-up' : rankChange < 0 ? 'rank-down' : 'rank-same';
                const changeIcon = rankChange > 0 ? 'â†‘' : rankChange < 0 ? 'â†“' : '';
                const changeText = rankChange !== 0 ? Math.abs(rankChange) : '';
                
                eliteHTML += `
                    <div class="elite-card" data-rank="${rank}">
                        <div class="elite-rank">${rank}</div>
                        
                        <div class="elite-content">
                            <div class="elite-avatar" style="border-color: ${getAvatarColor(person.name)}; background: ${getAvatarColor(person.name)}22; color: ${getAvatarColor(person.name)};">
                                ${getInitials(person.name)}
                            </div>
                            
                            <div class="elite-info">
                                <h4 class="elite-name">${person.name}</h4>
                                <span class="elite-type">${person.type === 'teacher' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ'}</span>
                                
                                ${rankChange !== 0 ? `
                                    <div style="font-size: 0.8rem; margin-top: 5px;">
                                        <span class="${changeClass}">
                                            ${changeIcon}${changeText} å
                                        </span>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        
                        <div class="elite-stats">
                            <div class="elite-stat">
                                <div class="elite-stat-value">${person.quoteCount}</div>
                                <div class="elite-stat-label">è¯­å½•æ•°</div>
                            </div>
                            <div class="elite-stat">
                                <div class="elite-stat-value">${person.mentionedCount}</div>
                                <div class="elite-stat-label">è¢«æåŠ</div>
                            </div>
                            <div class="elite-stat">
                                <div class="elite-stat-value">${person.influenceScore.toFixed(1)}</div>
                                <div class="elite-stat-label">å½±å“åŠ›</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = eliteHTML;
            
            // æ·»åŠ å…¥åœºåŠ¨ç”»
            if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
                gsap.from('.elite-card', {
                    y: 50,
                    opacity: 0,
                    duration: 0.8,
                    stagger: 0.1,
                    ease: "power2.out",
                    scrollTrigger: {
                        trigger: '.elite-rankings',
                        start: 'top 80%',
                        toggleActions: 'play none none none'
                    }
                });
            }
        }
        
        // æ¸²æŸ“å†å²æ’åå›¾è¡¨
        function renderHistoryChart(topNames) {
            const ctx = document.getElementById('historyChart');
            if (!ctx) return;
            
            // æ¨¡æ‹Ÿå†å²æ•°æ®
            const historyData = generateHistoryData(topNames);
            const periods = ['12æœˆ21æ—¥', '12æœˆ22æ—¥', '12æœˆ23æ—¥', '12æœˆ24æ—¥', '12æœˆ25æ—¥', '12æœˆ26æ—¥', '12æœˆ27æ—¥'];
            
            const datasets = topNames.slice(0, 5).map((name, index) => {
                const colors = ['#FFD700', '#C0C0C0', '#CD7F32', '#1E90FF', '#32CD32'];
                return {
                    label: name,
                    data: historyData[name] || [],
                    borderColor: colors[index % colors.length],
                    backgroundColor: colors[index % colors.length] + '20',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 5,
                    pointBackgroundColor: colors[index % colors.length]
                };
            });
            
            if (historyChart) {
                historyChart.destroy();
            }
            
            if (typeof Chart !== 'undefined') {
                historyChart = new Chart(ctx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: periods,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: '#fff',
                                    font: {
                                        size: 14
                                    }
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#FFD700',
                                bodyColor: '#fff',
                                borderColor: '#FFD700',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#ccc'
                                }
                            },
                            y: {
                                reverse: true, // æ’åç¬¬1æœ€å¥½ï¼Œæ‰€ä»¥åœ¨å›¾è¡¨é¡¶éƒ¨
                                min: 1,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#ccc',
                                    callback: function(value) {
                                        return 'ç¬¬' + value + 'å';
                                    }
                                }
                            }
                        }
                    }
                });
            } else {
                // å¦‚æœChart.jsæœªåŠ è½½ï¼Œæ˜¾ç¤ºæç¤º
                ctx.parentElement.innerHTML = '<div class="no-data">å›¾è¡¨åº“åŠ è½½å¤±è´¥ï¼Œæ— æ³•æ˜¾ç¤ºå†å²è¶‹åŠ¿å›¾</div>';
            }
        }
        
        // æ¸²æŸ“è¿›åº¦æ¡
        function renderProgressBars(rankings) {
            const container = document.getElementById('progress-bars');
            if (!container) return;
            
            const top10 = rankings.slice(0, 10);
            
            if (!top10 || top10.length === 0) {
                container.innerHTML = '<div class="no-data">æš‚æ— è¿›åº¦æ¡æ•°æ®</div>';
                return;
            }
            
            // æ‰¾å‡ºæœ€å¤§å½±å“åŠ›å€¼ï¼Œç”¨äºè®¡ç®—ç™¾åˆ†æ¯”
            const maxInfluence = Math.max(...top10.map(p => p.influenceScore));
            
            let progressHTML = '';
            
            top10.forEach((person, index) => {
                const rank = index + 1;
                const percentage = (person.influenceScore / maxInfluence) * 100;
                const rankChange = getRankChange(person.name);
                const changeClass = rankChange > 0 ? 'rank-up' : rankChange < 0 ? 'rank-down' : 'rank-same';
                const changeIcon = rankChange > 0 ? 'â†‘' : rankChange < 0 ? 'â†“' : '';
                const changeText = rankChange !== 0 ? Math.abs(rankChange) : '';
                
                progressHTML += `
                    <div class="progress-item">
                        <div class="progress-header">
                            <span class="progress-name">
                                <span class="rank-number">${rank}.</span> ${person.name}
                            </span>
                            <span class="progress-rank">
                                å½±å“åŠ›: ${person.influenceScore.toFixed(1)}
                                ${rankChange !== 0 ? `
                                    <span class="${changeClass}" style="margin-left: 10px;">
                                        ${changeIcon}${changeText}
                                    </span>
                                ` : ''}
                            </span>
                        </div>
                        
                        <div class="progress-bar-bg">
                            <div class="progress-bar-fill" style="width: ${percentage}%;"></div>
                        </div>
                        
                        <div class="progress-stats">
                            <span>${person.quoteCount} æ¡è¯­å½•</span>
                            <span>${person.mentionedCount} æ¬¡è¢«æåŠ</span>
                            <span>${person.type === 'teacher' ? person.subject : 'å­¦ç”Ÿ'}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = progressHTML;
            
            // æ·»åŠ è¿›åº¦æ¡åŠ¨ç”»
            setTimeout(() => {
                const progressBars = document.querySelectorAll('.progress-bar-fill');
                progressBars.forEach(bar => {
                    const width = bar.style.width;
                    bar.style.width = '0';
                    setTimeout(() => {
                        bar.style.width = width;
                    }, 100);
                });
            }, 500);
        }
        
        // è·å–æ’åå˜åŒ–ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
        function getRankChange(name) {
            // æ¨¡æ‹Ÿæ’åå˜åŒ–ï¼š-5åˆ°5ä¹‹é—´çš„éšæœºæ•°ï¼Œ0è¡¨ç¤ºä¸å˜
            const change = Math.floor(Math.random() * 11) - 5;
            // ç¡®ä¿ä¸ä¼šå‡ºç°å¤ªå¤§å˜åŒ–ï¼ˆæœ€å¤šÂ±5ï¼‰
            return Math.max(-5, Math.min(5, change));
        }
        
        // æ ¹æ®ç±»å‹ç­›é€‰å’Œæ’åºæ•°æ®
        function getRankedData(type) {
            let filteredData = [...allRankData];
            
            // æ ¹æ®ç±»å‹ç­›é€‰
            if (type === 'teachers') {
                filteredData = filteredData.filter(item => item.type === 'teacher');
            } else if (type === 'students') {
                filteredData = filteredData.filter(item => item.type === 'student');
            } else if (type === 'quotes') {
                // æŒ‰è¯­å½•æ•°é‡æ’åº
                filteredData.sort((a, b) => b.quoteCount - a.quoteCount);
                return filteredData;
            } else if (type === 'mentioned') {
                // æŒ‰è¢«æåŠæ¬¡æ•°æ’åº
                filteredData.sort((a, b) => b.mentionedCount - a.mentionedCount);
                return filteredData;
            } else if (type === 'progress') {
                // æ¨¡æ‹Ÿè¿›æ­¥æœ€å¿«ï¼ˆéšæœºç”Ÿæˆå˜åŒ–å€¼ï¼‰
                filteredData.forEach(item => {
                    item.progress = Math.floor(Math.random() * 20) - 10;
                });
                filteredData.sort((a, b) => b.progress - a.progress);
                return filteredData;
            }
            
            // é»˜è®¤æŒ‰å½±å“åŠ›æ’åº
            filteredData.sort((a, b) => b.influenceScore - a.influenceScore);
            return filteredData;
        }
        
        // æ›´æ–°æ‰€æœ‰æ’åæ˜¾ç¤º
        function updateRankings(type) {
            currentRankType = type;
            const rankedData = getRankedData(type);
            
            // æ¸²æŸ“å‰ä¸‰å
            renderPodium(rankedData.slice(0, 3));
            
            // æ¸²æŸ“ç²¾è‹±æ¦œå•
            renderEliteRankings(rankedData);
            
            // æ¸²æŸ“å†å²å›¾è¡¨ï¼ˆå–å‰5åï¼‰
            const topNames = rankedData.slice(0, 5).map(p => p.name);
            renderHistoryChart(topNames);
            
            // æ¸²æŸ“è¿›åº¦æ¡
            renderProgressBars(rankedData);
            
            // æ’­æ”¾ç¤¼èŠ±ç‰¹æ•ˆï¼ˆä»…åœ¨åˆ‡æ¢åˆ°ç»¼åˆæ¦œæ—¶ï¼‰
            if (type === 'all') {
                setTimeout(createConfetti, 500);
            }
            
            // éšè—åŠ è½½åŠ¨ç”»
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.style.opacity = '0';
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                }, 500);
            }
        }
        
        // ============================================
        // é¡µé¢åˆå§‹åŒ–
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // æ›´æ–°é¡µé¢ä¸Šçš„æ—¶é—´æ˜¾ç¤º
            const updateTimeDisplay = document.getElementById('updateTimeDisplay');
            if (updateTimeDisplay) {
                updateTimeDisplay.textContent = `æ•°æ®æ›´æ–°äºï¼š${UPDATE_TIME}`;
            }
            
            // åˆå§‹åŒ–ç‰¹æ•ˆ
            try {
                initParticleBackground();
                initSpotlight();
            } catch (e) {
                console.warn('ç‰¹æ•ˆåˆå§‹åŒ–å¤±è´¥:', e);
            }
            
            // ç”Ÿæˆæ•°æ®
            allRankData = generateRankData();
            
            // åˆå§‹æ˜¾ç¤ºç»¼åˆæ¦œ
            updateRankings('all');
            
            // ============================================
            // äº‹ä»¶ç»‘å®š
            // ============================================
            
            // å¯¼èˆªæ ‡ç­¾ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.rank-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    document.querySelectorAll('.rank-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // è·å–æ’åç±»å‹
                    const type = this.dataset.rankType;
                    
                    // æ›´æ–°æ’å
                    updateRankings(type);
                });
            });
            
            // ============================================
            // ä¾§è¾¹æ åŠŸèƒ½
            // ============================================
            
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const mainContent = document.getElementById('rank-main-content');
            
            if (sidebar && sidebarToggle && mainContent) {
                let sidebarCollapsed = false;

                sidebarToggle.addEventListener('click', () => {
                    sidebarCollapsed = !sidebarCollapsed;
                    if (sidebarCollapsed) {
                        sidebar.classList.add('collapsed');
                        mainContent.classList.add('sidebar-collapsed');
                        sidebarToggle.textContent = 'â˜°';
                    } else {
                        sidebar.classList.remove('collapsed');
                        mainContent.classList.remove('sidebar-collapsed');
                        sidebarToggle.textContent = 'â‰¡';
                    }
                });
            }
            
            // ä¾§è¾¹æ å¯¼èˆªé¡¹ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.teacher-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // å¦‚æœæ˜¯é“¾æ¥ï¼Œå…è®¸è·³è½¬
                    if (this.hasAttribute('href')) {
                        return;
                    }
                    e.preventDefault();
                    // å¦‚æœæ˜¯è¯­å½•é¡¹ï¼Œè·³å›ä¸»é¡µ
                    window.location.href = 'index.html';
                });
            });
            
            // ============================================
            // å›åˆ°é¡¶éƒ¨åŠŸèƒ½
            // ============================================
            
            const backToTopBtn = document.getElementById('back-to-top');
            
            if (backToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 300) {
                        backToTopBtn.classList.add('visible');
                    } else {
                        backToTopBtn.classList.remove('visible');
                    }
                });

                backToTopBtn.addEventListener('click', () => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
                
                // åˆå§‹éšè—å›åˆ°é¡¶éƒ¨æŒ‰é’®
                backToTopBtn.classList.remove('visible');
            }
            
            // é¡µé¢åŠ è½½å®Œæˆåæ’­æ”¾ä¸€æ¬¡ç¤¼èŠ±
            setTimeout(() => {
                createConfetti();
            }, 1000);
            
            // åˆå§‹åŒ–æ»šåŠ¨åŠ¨ç”»
            if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
                gsap.registerPlugin(ScrollTrigger);
                
                // æ·»åŠ æ»šåŠ¨è§¦å‘åŠ¨ç”»
                setTimeout(() => {
                    const elements = document.querySelectorAll('.podium, .elite-card, .progress-item');
                    elements.forEach(element => {
                        gsap.from(element, {
                            scrollTrigger: {
                                trigger: element,
                                start: 'top 80%',
                                toggleActions: 'play none none none'
                            },
                            y: 30,
                            opacity: 0,
                            duration: 0.8,
                            ease: "power2.out"
                        });
                    });
                }, 500);
            }
        });
    </script>
</body>
</html>
