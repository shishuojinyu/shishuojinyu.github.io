<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»Ÿè®¡æ•°æ® - ä¸–è¯´é‡‘è¯­</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        /* ç»Ÿè®¡é¡µé¢ä¸“ç”¨æ ·å¼ */
        .summary-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .stats-header {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #007bff;
        }
        
        .stats-header h1 {
            margin-top: 0;
            color: #333;
        }
        
        .stats-meta {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .stats-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 12px;
            margin-top: 15px;
            color: #856404;
            font-size: 14px;
        }
        
        .data-filter {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .filter-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-box {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            margin-top: 0;
            margin-bottom: 20px;
            color: #333;
            font-size: 18px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .search-box {
            position: relative;
            flex: 1;
            min-width: 300px;
        }
        
        .search-box input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 14px;
        }
        
        .search-box::before {
            content: "ğŸ”";
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        
        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .export-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(40,167,69,0.2);
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .stats-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #e0e0e0;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        
        .stats-table th:hover {
            background: #f0f0f0;
        }
        
        .stats-table th.sort-asc::after {
            content: " â†‘";
            color: #007bff;
        }
        
        .stats-table th.sort-desc::after {
            content: " â†“";
            color: #007bff;
        }
        
        .stats-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .stats-table tr:hover {
            background: #f8f9fa;
        }
        
        .type-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .type-teacher {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .type-student {
            background: #f3e5f5;
            color: #7b1fa2;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
        }
        
        .pagination-btn {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: #f0f0f0;
        }
        
        .pagination-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #007bff;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body class="content-page">
    <!-- å·¦ä¾§ä¾§è¾¹æ å®¹å™¨ -->
    <div class="sidebar" id="sidebar">
        <button class="sidebar-toggle" id="sidebar-toggle">â‰¡</button>
        <div class="sidebar-content">
            <div class="sidebar-header">
                <h2 class="sidebar-main-title">ä¸–è¯´é‡‘è¯­</h2>
                <p class="sidebar-sub-title">æ ¡å›­è¯­å½•æ¡£æ¡ˆé¦†</p>
                <hr class="sidebar-divider">
            </div>
            
            <div class="subject-list">
                <!-- è¯­æ–‡ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“– è¯­æ–‡</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="é™ˆç³">é™ˆç³</span>
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="èŒƒå¶æ–Œ">èŒƒå¶æ–Œ</span>
                        <span class="teacher-item" data-subject="è¯­æ–‡" data-teacher="éƒ‘å®‡">éƒ‘å®‡</span>
                    </div>
                </div>
                
                <!-- æ•°å­¦ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ”¢ æ•°å­¦</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ•°å­¦" data-teacher="é‡‘å£°">é‡‘å£°</span>
                    </div>
                </div>
                
                <!-- è‹±è¯­ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ—£ï¸ è‹±è¯­</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="è‹±è¯­" data-teacher="å†¯ç§‹äº‘">å†¯ç§‹äº‘</span>
                        <span class="teacher-item" data-subject="è‹±è¯­" data-teacher="èµµæ°¸æ’">èµµæ°¸æ’</span>
                    </div>
                </div>
                
                <!-- ç‰©ç† -->
                <div class="subject-item">
                    <span class="subject-title">âš›ï¸ ç‰©ç†</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="ç‰©ç†" data-teacher="é¢œæœ‰è™¹">é¢œæœ‰è™¹</span>
                    </div>
                </div>
                
                <!-- åŒ–å­¦ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ§ª åŒ–å­¦</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="åŒ–å­¦" data-teacher="ä¸¥å¿—èŠ³">ä¸¥å¿—èŠ³</span>
                        <span class="teacher-item" data-subject="åŒ–å­¦" data-teacher="ç¨‹ä¿æƒ">ç¨‹ä¿æƒ</span>
                    </div>
                </div>
                
                <!-- ç”Ÿç‰© -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ§¬ ç”Ÿç‰©</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="ç”Ÿç‰©" data-teacher="é™ˆå‰ç´">é™ˆå‰ç´</span>
                        <span class="teacher-item" data-subject="ç”Ÿç‰©" data-teacher="å¶æ°¸è">å¶æ°¸è</span>
                    </div>
                </div>
                
                <!-- æ”¿æ²» -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“œ æ”¿æ²»</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ”¿æ²»" data-teacher="å‚…æ•">å‚…æ•</span>
                        <span class="teacher-item" data-subject="æ”¿æ²»" data-teacher="æ—æ ¹">æ—æ ¹</span>
                    </div>
                </div>
                
                <!-- æ•™å®˜è¯­å½• -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ¥ æ•™å®˜è¯­å½•</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="æ•™å®˜è¯­å½•" data-teacher="æ˜Ÿè¾°">æ˜Ÿè¾°</span>
                    </div>
                </div>
                
                <!-- å­¦ç”Ÿè¯­å½• -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ‘¨â€ğŸ“ å­¦ç”Ÿè¯­å½•</span>
                    <div class="teacher-list">
                        <span class="teacher-item" data-subject="å­¦ç”Ÿè¯­å½•" data-teacher="æœªæ•´ç†">å­¦ç”Ÿè¯­å½•</span>
                    </div>
                </div>
                
                <!-- æ•°æ®åˆ†æ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ“Š æ•°æ®åˆ†æ</span>
                    <div class="teacher-list">
                        <a href="rank.html" class="teacher-item" data-subject="æ•°æ®åˆ†æ" data-teacher="äººæ°”æ’è¡Œæ¦œ">äººæ°”æ’è¡Œæ¦œğŸ†</a>
                        <a href="summary.html" class="teacher-item" data-subject="æ•°æ®åˆ†æ" data-teacher="ç»Ÿè®¡">ç»Ÿè®¡ğŸ“ˆ</a>
                    </div>
                </div>
                
                <!-- èµ›åšæ¡£æ¡ˆ -->
                <div class="subject-item">
                    <span class="subject-title">ğŸ¤– èµ›åšæ¡£æ¡ˆ</span>
                    <div class="teacher-list">
                        <a href="picture.html" class="teacher-item" data-subject="èµ›åšæ¡£æ¡ˆ" data-teacher="å›¾ç‰‡é›†">å›¾ç‰‡é›†</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å³ä¾§å†…å®¹åŒº -->
    <div class="main-content" id="main-content">
        <div class="top-bar">
            <a href="search.html" class="search-btn">
                <span>ğŸ”</span> æœç´¢
            </a>
        </div>

        <!-- ç»Ÿè®¡é¡µé¢å†…å®¹ -->
        <div class="summary-container">
            <!-- ç»Ÿè®¡æ•°æ®å¤´éƒ¨ -->
            <div class="stats-header">
                <h1>ğŸ“Š è¯­å½•ç»Ÿè®¡æ•°æ®ä¸­å¿ƒ</h1>
                <div class="stats-meta">
                    <!-- è¯·åœ¨è¿™é‡Œä¿®æ”¹æ›´æ–°æ—¶é—´ -->
                    æœ¬ç½‘ç«™è¯­å½•æ”¶å½•æˆªæ­¢<span style="color: #007bff; font-weight: bold;" id="updateTimeDisplay">2025å¹´12æœˆ28æ—¥11æ—¶06åˆ†00ç§’</span>
                </div>
                <div class="stats-note">
                    âš ï¸ é‡è¦è¯´æ˜ï¼šéƒ¨åˆ†è¯­å½•ä¸­å¯èƒ½å¯¹æŸäººä½¿ç”¨å¤–å·æ¥ç§°å‘¼ï¼Œå› æ­¤æ•°æ®çŸ­æ—¶é—´å†…éš¾ä»¥å‡†ç¡®ç»Ÿè®¡ï¼Œå¯èƒ½æœ‰åå·®ã€‚æœ¬äººå°†ä¼šåœ¨é«˜è€ƒåå®Œæˆå…¨éƒ¨å·¥ä½œã€‚
                </div>
            </div>
            
            <!-- æ•°æ®ç­›é€‰ -->
            <div class="data-filter">
                <h3 style="margin-top: 0; margin-bottom: 15px;">æ•°æ®ç±»å‹ç­›é€‰</h3>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-type="all">å…¨éƒ¨æ•°æ®</button>
                    <button class="filter-btn" data-type="teachers">æ•™å¸ˆæ•°æ®</button>
                    <button class="filter-btn" data-type="students">å­¦ç”Ÿæ•°æ®</button>
                </div>
            </div>
            
            <!-- ç»Ÿè®¡æ‘˜è¦å¡ç‰‡ -->
            <div class="stats-summary" id="stats-summary">
                <!-- åŠ¨æ€ç”Ÿæˆç»Ÿè®¡å¡ç‰‡ -->
            </div>
            
            <!-- å›¾è¡¨åŒºåŸŸ -->
            <div class="charts-container">
                <div class="chart-box">
                    <h3 class="chart-title">è¯­å½•æ•°é‡åˆ†å¸ƒï¼ˆæŒ‰åº§å·ï¼‰</h3>
                    <canvas id="lineChart"></canvas>
                </div>
                <div class="chart-box">
                    <h3 class="chart-title">æ•°æ®æ„æˆåˆ†æ</h3>
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
            
            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="table-container">
                <div class="table-controls">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="æœç´¢å§“åæˆ–ç¼–å·...">
                    </div>
                    <button class="export-btn" id="exportBtn">
                        ğŸ“Š å¯¼å‡ºExcel
                    </button>
                </div>
                
                <table class="stats-table" id="statsTable">
                    <thead>
                        <tr>
                            <th data-sort="id">ç¼–å·/åº§å·</th>
                            <th data-sort="name">å§“å</th>
                            <th data-sort="type">ç±»å‹</th>
                            <th data-sort="subject">ç§‘ç›®/ç­çº§</th>
                            <th data-sort="quoteCount">è¯­å½•æ•°é‡</th>
                            <th data-sort="mentionedCount">è¢«æåŠæ¬¡æ•°</th>
                            <th data-sort="influenceScore">å½±å“åŠ›æŒ‡æ•°</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- åŠ¨æ€ç”Ÿæˆè¡¨æ ¼æ•°æ® -->
                    </tbody>
                </table>
                
                <!-- åˆ†é¡µæ§ä»¶ -->
                <div class="pagination" id="pagination">
                    <!-- åŠ¨æ€ç”Ÿæˆåˆ†é¡µæŒ‰é’® -->
                </div>
            </div>
        </div>
    </div>

    <button class="back-to-top" id="back-to-top">â†‘</button>

    <script>
        // ============================================
        // ã€æ•°æ®é…ç½®åŒºã€‘ä»è¿™é‡Œå¼€å§‹ä¿®æ”¹ï¼
        // ============================================
        
        // 1. è¯­å½•æ”¶å½•æˆªæ­¢æ—¶é—´ï¼ˆè¯·ä¿®æ”¹è¿™é‡Œï¼‰
        const UPDATE_TIME = "2025å¹´12æœˆ28æ—¥11æ—¶06åˆ†00ç§’";
        
        // 2. æ•™å¸ˆæ•°æ®é…ç½®ï¼ˆæ ¼å¼ï¼šå§“å: [è¯­å½•æ•°é‡, è¢«æåŠæ¬¡æ•°]ï¼‰
        //    æ³¨æ„ï¼šå§“åå¿…é¡»å’Œä¾§è¾¹æ ä¸­çš„ä¸€è‡´
       const TEACHER_DATA = {
            "é™ˆç³": [341, 3],
            "èŒƒå¶æ–Œ": [19, 3],
            "éƒ‘å®‡": [30, 2],
            "é‡‘å£°": [870, 29],
            "å†¯ç§‹äº‘": [42, 1],
            "èµµæ°¸æ’": [27, 1],
            "é¢œæœ‰è™¹": [322, 3],
            "ä¸¥å¿—èŠ³": [97, 3],
            "ç¨‹ä¿æƒ": [20, 4],
            "é™ˆå‰ç´": [102, 3],
            "å¶æ°¸è": [21, 1],
            "å‚…æ•": [26, 2],
            "æ—æ ¹": [104, 2],
            "æ˜Ÿè¾°": [29, 0]
        };
        
        // 3. å­¦ç”Ÿæ•°æ®é…ç½®ï¼ˆæ ¼å¼ï¼šå§“å: [è¯­å½•æ•°é‡, è¢«æåŠæ¬¡æ•°]ï¼‰
        //    æ³¨æ„ï¼šå§“åå¿…é¡»å’Œå­¦ç”Ÿåå•ä¸­çš„ä¸€è‡´
        //    æš‚æ—¶å…¨éƒ¨è®¾ç½®ä¸º[1, 1]ï¼Œæ‚¨å¯ä»¥é€ä¸ªä¿®æ”¹
       const STUDENT_DATA = {
            "è°¢æ˜Šè¾°": [0, 2],
            "é‚±æµ©å®¸": [1, 2],
            "éŸ©é‡‘æˆ": [0, 1],
            "éƒ‘æ™¯ä¸¥": [0, 5],
            "éƒ‘ä¹é¼": [0, 4],
            "ç‹æµ©å®‡": [0, 0],
            "é»„èŠ·è£³": [0, 0],
            "åˆ˜æ¢“æ¥·": [2, 39],
            "é™ˆæ—ä½³": [5, 18],
            "å€ªæ¥·æ¥ ": [0, 2],
            "é™ˆæµ©å¤©": [0, 3],
            "å¼ å­æ‰¬": [1, 16],
            "å´æ˜Šå¤©": [0, 5],
            "å¼ çš“": [3, 12],
            "æ±ªåƒé›…": [0, 0],
            "é»„æœµå„¿": [0, 0],
            "å´æ³½æ›¦": [0, 2],
            "æ—æ›¾ç«¤": [0, 3],
            "é™ˆæ˜“èˆª": [0, 4],
            "æ—è£æ˜•": [0, 2],
            "æ—ç­ é“­": [0, 1],
            "å¶ä¸€å¸†": [1, 7],
            "é»„æ¥·æ°": [0, 2],
            "æ¸©é™åª›": [0, 1],
            "å­™æ¾œè": [0, 0],
            "é»„å®¶è€€": [13, 64],
            "å¶å¯è¿": [0, 6],
            "å…°å˜‰æ¶µ": [0, 3],
            "å•å¥•é“®": [6, 8],
            "å¸¸å‡¯": [0, 14],
            "æ—å³»æº": [0, 0],
            "ç« çš“æ™¨": [0, 2],
            "é™ˆæ å½¤": [0, 0],
            "é™ˆä½³é‘«": [0, 2],
            "å´å…†å…ƒ": [0, 0],
            "ä½•å†¬æ˜±": [0, 2],
            "èµ–ç¥‰ç¥º": [0, 2],
            "æ—é–è½©": [0, 0],
            "è”¡è¾¾ç¤¼": [2, 6],
            "å¶å­å°§": [0, 1],
            "è”¡é“ æ³½": [0, 6],
            "é™†åº­é”´": [0, 0],
            "æ—å˜‰è±ª": [1, 0],
            "é™ˆç¿æ°": [0, 3],
            "æ±Ÿæ™ºæˆ": [0, 1],
            "ææµ©ä¸€": [0, 1],
            "æå¥¥": [0, 2],
            "åˆ˜é›¨çª": [0, 2],
            "åˆ˜è¾°ç¿": [0, 0],
            "æ—äº¦è½²": [0, 5],
            "å·«å¤æœµ": [0, 0],
            "å‘¨å–„è¿›": [0, 1],
            "æ—é“ å¢¨": [2, 13],
            "ä¼åšé”´": [0, 3]
};
        
        // 4. å½±å“åŠ›æŒ‡æ•°æƒé‡ï¼ˆå¯ä»¥è°ƒæ•´ï¼‰
        const WEIGHTS = {
            quoteWeight: 1.0,      // è¯­å½•æ•°é‡æƒé‡
            mentionedWeight: 0.7   // è¢«æåŠæ¬¡æ•°æƒé‡
        };
        
        // ============================================
        // ã€ä»¥ä¸‹ä¸ºå›ºå®šé…ç½®ï¼Œæ— éœ€ä¿®æ”¹ã€‘
        // ============================================
        
        // å­¦ç”Ÿåå•ï¼ˆæŒ‰åº§å·é¡ºåºï¼‰
        const STUDENTS = [
            "è°¢æ˜Šè¾°", "é‚±æµ©å®¸", "éŸ©é‡‘æˆ", "éƒ‘æ™¯ä¸¥", "éƒ‘ä¹é¼", "ç‹æµ©å®‡", "é»„èŠ·è£³", "åˆ˜æ¢“æ¥·", "é™ˆæ—ä½³",
            "å€ªæ¥·æ¥ ", "é™ˆæµ©å¤©", "å¼ å­æ‰¬", "å´æ˜Šå¤©", "å¼ çš“", "æ±ªåƒé›…", "é»„æœµå„¿", "å´æ³½æ›¦", "æ—æ›¾ç«¤",
            "é™ˆæ˜“èˆª", "æ—è£æ˜•", "æ—ç­ é“­", "å¶ä¸€å¸†", "é»„æ¥·æ°", "æ¸©é™åª›", "å­™æ¾œè", "é»„å®¶è€€", "å¶å¯è¿",
            "å…°å˜‰æ¶µ", "å•å¥•é“®", "å¸¸å‡¯", "æ—å³»æº", "ç« çš“æ™¨", "é™ˆæ å½¤", "é™ˆä½³é‘«", "å´å…†å…ƒ", "ä½•å†¬æ˜±",
            "èµ–ç¥‰ç¥º", "æ—é–è½©", "è”¡è¾¾ç¤¼", "å¶å­å°§", "è”¡é“ æ³½", "é™†åº­é”´", "æ—å˜‰è±ª", "é™ˆç¿æ°", "æ±Ÿæ™ºæˆ",
            "ææµ©ä¸€", "æå¥¥", "åˆ˜é›¨çª", "åˆ˜è¾°ç¿", "æ—äº¦è½²", "å·«å¤æœµ", "å‘¨å–„è¿›", "æ—é“ å¢¨", "ä¼åšé”´"
        ];
        
        // æ•™å¸ˆç§‘ç›®ä¿¡æ¯
        const TEACHER_SUBJECTS = {
            "é™ˆç³": "è¯­æ–‡",
            "èŒƒå¶æ–Œ": "è¯­æ–‡",
            "éƒ‘å®‡": "è¯­æ–‡",
            "é‡‘å£°": "æ•°å­¦",
            "å†¯ç§‹äº‘": "è‹±è¯­",
            "èµµæ°¸æ’": "è‹±è¯­",
            "é¢œæœ‰è™¹": "ç‰©ç†",
            "ä¸¥å¿—èŠ³": "åŒ–å­¦",
            "ç¨‹ä¿æƒ": "åŒ–å­¦",
            "é™ˆå‰ç´": "ç”Ÿç‰©",
            "å¶æ°¸è": "ç”Ÿç‰©",
            "å‚…æ•": "æ”¿æ²»",
            "æ—æ ¹": "æ”¿æ²»",
            "æ˜Ÿè¾°": "æ•™å®˜è¯­å½•"
        };
        
        // è¡¨æ ¼åˆ†é¡µé…ç½®
        const TABLE_CONFIG = {
            pageSize: 15,          // æ¯é¡µæ˜¾ç¤ºè¡Œæ•°
            currentPage: 1         // å½“å‰é¡µç 
        };
        
        // ============================================
        // æ•°æ®å‡†å¤‡å’Œè®¡ç®—å‡½æ•°
        // ============================================
        
        // ç”Ÿæˆå®Œæ•´æ•°æ®é›†åˆ
        function generateStatsData() {
            const allData = [];
            
            // æ·»åŠ æ•™å¸ˆæ•°æ®
            Object.keys(TEACHER_DATA).forEach((teacherName, index) => {
                const [quoteCount, mentionedCount] = TEACHER_DATA[teacherName];
                const influenceScore = calculateInfluenceScore(quoteCount, mentionedCount);
                const subject = TEACHER_SUBJECTS[teacherName] || "æœªçŸ¥ç§‘ç›®";
                
                allData.push({
                    id: `T${String(index + 1).padStart(2, '0')}`,
                    originalId: index + 1,
                    name: teacherName,
                    displayName: `${subject}-${teacherName}`,
                    type: "teacher",
                    subject: subject,
                    quoteCount: quoteCount,
                    mentionedCount: mentionedCount,
                    influenceScore: influenceScore
                });
            });
            
            // æ·»åŠ å­¦ç”Ÿæ•°æ®
            STUDENTS.forEach((studentName, index) => {
                // ä»é…ç½®ä¸­è·å–æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤å€¼[0, 0]
                const studentStats = STUDENT_DATA[studentName] || [0, 0];
                const [quoteCount, mentionedCount] = studentStats;
                const influenceScore = calculateInfluenceScore(quoteCount, mentionedCount);
                const seatNumber = String(index + 1).padStart(2, '0');
                
                allData.push({
                    id: seatNumber,
                    originalId: index + 1,
                    name: studentName,
                    displayName: `${seatNumber}-${studentName}`,
                    type: "student",
                    subject: "1ç­",
                    quoteCount: quoteCount,
                    mentionedCount: mentionedCount,
                    influenceScore: influenceScore
                });
            });
            
            return allData;
        }
        
        // è®¡ç®—å½±å“åŠ›æŒ‡æ•°
        function calculateInfluenceScore(quoteCount, mentionedCount) {
            return (quoteCount * WEIGHTS.quoteWeight) + (mentionedCount * WEIGHTS.mentionedWeight);
        }
        
        // è·å–ç»Ÿè®¡æ•°æ®æ‘˜è¦
        function getStatsSummary(data) {
            const teachers = data.filter(item => item.type === 'teacher');
            const students = data.filter(item => item.type === 'student');
            
            const totalQuotes = data.reduce((sum, item) => sum + item.quoteCount, 0);
            const totalMentions = data.reduce((sum, item) => sum + item.mentionedCount, 0);
            
            return {
                totalCount: data.length,
                teacherCount: teachers.length,
                studentCount: students.length,
                totalQuotes: totalQuotes,
                totalMentions: totalMentions,
                avgQuotesPerTeacher: teachers.length > 0 ? 
                    (teachers.reduce((sum, item) => sum + item.quoteCount, 0) / teachers.length).toFixed(1) : 0,
                avgMentionsPerPerson: data.length > 0 ? 
                    (totalMentions / data.length).toFixed(1) : 0,
                avgInfluenceScore: data.length > 0 ? 
                    (data.reduce((sum, item) => sum + item.influenceScore, 0) / data.length).toFixed(1) : 0
            };
        }
        
        // ============================================
        // å›¾è¡¨å‡½æ•°
        // ============================================
        
        let lineChart, pieChart;
        
        // ç»˜åˆ¶æŠ˜çº¿å›¾ï¼ˆæŒ‰åº§å·æ’åºï¼‰
        function renderLineChart(data, type = 'all') {
            const ctx = document.getElementById('lineChart').getContext('2d');
            
            // æ ¹æ®ç­›é€‰ç±»å‹å‡†å¤‡æ•°æ®
            let filteredData = [];
            let labels = [];
            let quoteData = [];
            let mentionData = [];
            
            if (type === 'students') {
                // å­¦ç”Ÿæ•°æ®æŒ‰åº§å·æ’åº
                filteredData = data
                    .filter(item => item.type === 'student')
                    .sort((a, b) => a.originalId - b.originalId);
                
                labels = filteredData.map(item => item.id);
                quoteData = filteredData.map(item => item.quoteCount);
                mentionData = filteredData.map(item => item.mentionedCount);
            } else if (type === 'teachers') {
                // æ•™å¸ˆæ•°æ®æŒ‰è¯­å½•æ•°é‡æ’åº
                filteredData = data
                    .filter(item => item.type === 'teacher')
                    .sort((a, b) => b.quoteCount - a.quoteCount);
                
                labels = filteredData.map(item => item.name.substring(0, 6));
                quoteData = filteredData.map(item => item.quoteCount);
                mentionData = filteredData.map(item => item.mentionedCount);
            } else {
                // å…¨éƒ¨æ•°æ®æŒ‰IDæ’åº
                filteredData = [...data]
                    .sort((a, b) => {
                        if (a.type === b.type) {
                            return a.originalId - b.originalId;
                        }
                        return a.type === 'teacher' ? -1 : 1;
                    });
                
                labels = filteredData.map(item => 
                    item.type === 'teacher' ? `T${item.id.substring(1)}` : item.id
                );
                quoteData = filteredData.map(item => item.quoteCount);
                mentionData = filteredData.map(item => item.mentionedCount);
            }
            
            if (lineChart) {
                lineChart.destroy();
            }
            
            lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'è¯­å½•æ•°é‡',
                            data: quoteData,
                            borderColor: '#007bff',
                            backgroundColor: 'rgba(0, 123, 255, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'è¢«æåŠæ¬¡æ•°',
                            data: mentionData,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: type === 'students' ? 'å­¦ç”Ÿåº§å·' : 'äººå‘˜ç¼–å·'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'æ•°é‡'
                            }
                        }
                    }
                }
            });
        }
        
        // ç»˜åˆ¶é¥¼å›¾
        function renderPieChart(data, type = 'all') {
            const ctx = document.getElementById('pieChart').getContext('2d');
            
            let chartData = {};
            let chartLabels = [];
            let chartValues = [];
            let chartColors = [];
            
            if (type === 'students') {
                // å­¦ç”Ÿæ•°æ®ï¼šå‰5å vs å…¶ä»–
                const students = data.filter(item => item.type === 'student');
                const sortedStudents = [...students].sort((a, b) => b.influenceScore - a.influenceScore);
                const top5 = sortedStudents.slice(0, 5);
                const others = sortedStudents.slice(5);
                
                chartLabels = [...top5.map(s => s.name), 'å…¶ä»–'];
                chartValues = [
                    ...top5.map(s => s.influenceScore),
                    others.reduce((sum, s) => sum + s.influenceScore, 0)
                ];
                chartColors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#C9CBCF'];
                
            } else if (type === 'teachers') {
                // æ•™å¸ˆæ•°æ®ï¼šæŒ‰ç§‘ç›®åˆ†å¸ƒ
                const teachers = data.filter(item => item.type === 'teacher');
                const subjects = {};
                
                teachers.forEach(teacher => {
                    if (!subjects[teacher.subject]) {
                        subjects[teacher.subject] = 0;
                    }
                    subjects[teacher.subject] += teacher.quoteCount;
                });
                
                chartLabels = Object.keys(subjects);
                chartValues = Object.values(subjects);
                chartColors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#C9CBCF'];
                
            } else {
                // å…¨éƒ¨æ•°æ®ï¼šæ•™å¸ˆ vs å­¦ç”Ÿ
                const teachers = data.filter(item => item.type === 'teacher');
                const students = data.filter(item => item.type === 'student');
                
                chartLabels = ['æ•™å¸ˆ', 'å­¦ç”Ÿ'];
                chartValues = [
                    teachers.reduce((sum, t) => sum + t.quoteCount, 0),
                    students.reduce((sum, s) => sum + s.quoteCount, 0)
                ];
                chartColors = ['#007bff', '#28a745'];
            }
            
            if (pieChart) {
                pieChart.destroy();
            }
            
            pieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: chartValues,
                        backgroundColor: chartColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // ============================================
        // è¡¨æ ¼å’Œåˆ†é¡µå‡½æ•°
        // ============================================
        
        let allStatsData = [];
        let filteredData = [];
        let currentSort = { field: 'influenceScore', direction: 'desc' };
        let currentFilter = 'all';
        let currentSearch = '';
        
        // æ¸²æŸ“ç»Ÿè®¡æ‘˜è¦å¡ç‰‡
        function renderStatsSummary(data) {
            const summary = getStatsSummary(data);
            const container = document.getElementById('stats-summary');
            
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">æ€»äººæ•°</div>
                    <div class="stat-value">${summary.totalCount}</div>
                    <div class="stat-detail">${summary.teacherCount}å¸ˆ ${summary.studentCount}ç”Ÿ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">è¯­å½•æ€»æ•°</div>
                    <div class="stat-value">${summary.totalQuotes}</div>
                    <div class="stat-detail">æ•™å¸ˆäººå‡ ${summary.avgQuotesPerTeacher}æ¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">è¢«æåŠæ€»æ•°</div>
                    <div class="stat-value">${summary.totalMentions}</div>
                    <div class="stat-detail">äººå‡ ${summary.avgMentionsPerPerson}æ¬¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">å¹³å‡å½±å“åŠ›</div>
                    <div class="stat-value">${summary.avgInfluenceScore}</div>
                    <div class="stat-detail">å½“å‰ç­›é€‰: ${currentFilter === 'all' ? 'å…¨éƒ¨' : currentFilter === 'teachers' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ'}</div>
                </div>
            `;
        }
        
        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const startIndex = (TABLE_CONFIG.currentPage - 1) * TABLE_CONFIG.pageSize;
            const endIndex = startIndex + TABLE_CONFIG.pageSize;
            const pageData = filteredData.slice(startIndex, endIndex);
            
            tbody.innerHTML = '';
            
            pageData.forEach(item => {
                const row = document.createElement('tr');
                
                // æ ¹æ®ç­›é€‰ç±»å‹å†³å®šæ˜¾ç¤ºæ ¼å¼
                let nameDisplay = item.name;
                if (currentFilter === 'teachers') {
                    nameDisplay = `${item.subject}-${item.name}`;
                } else if (currentFilter === 'students') {
                    nameDisplay = `${item.id}-${item.name}`;
                }
                
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td><strong>${nameDisplay}</strong></td>
                    <td><span class="type-badge type-${item.type}">${item.type === 'teacher' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ'}</span></td>
                    <td>${item.subject}</td>
                    <td><strong style="color: #007bff;">${item.quoteCount}</strong></td>
                    <td><strong style="color: #28a745;">${item.mentionedCount}</strong></td>
                    <td><strong style="color: #ff6b6b;">${item.influenceScore.toFixed(1)}</strong></td>
                `;
                
                tbody.appendChild(row);
            });
            
            renderPagination();
        }
        
        // æ¸²æŸ“åˆ†é¡µæ§ä»¶
        function renderPagination() {
            const totalPages = Math.ceil(filteredData.length / TABLE_CONFIG.pageSize);
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let html = '';
            
            // ä¸Šä¸€é¡µæŒ‰é’®
            html += `
                <button class="pagination-btn" id="prevPage" ${TABLE_CONFIG.currentPage === 1 ? 'disabled' : ''}>
                    &laquo; ä¸Šä¸€é¡µ
                </button>
            `;
            
            // é¡µç æŒ‰é’®
            const maxVisible = 5;
            let startPage = Math.max(1, TABLE_CONFIG.currentPage - Math.floor(maxVisible / 2));
            let endPage = Math.min(totalPages, startPage + maxVisible - 1);
            
            if (endPage - startPage + 1 < maxVisible) {
                startPage = Math.max(1, endPage - maxVisible + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="pagination-btn ${i === TABLE_CONFIG.currentPage ? 'active' : ''}" data-page="${i}">
                        ${i}
                    </button>
                `;
            }
            
            // ä¸‹ä¸€é¡µæŒ‰é’®
            html += `
                <button class="pagination-btn" id="nextPage" ${TABLE_CONFIG.currentPage === totalPages ? 'disabled' : ''}>
                    ä¸‹ä¸€é¡µ &raquo;
                </button>
            `;
            
            // é¡µé¢ä¿¡æ¯
            html += `
                <span style="margin-left: 10px; color: #666; font-size: 14px;">
                    ç¬¬ ${TABLE_CONFIG.currentPage} / ${totalPages} é¡µï¼Œå…± ${filteredData.length} æ¡è®°å½•
                </span>
            `;
            
            pagination.innerHTML = html;
            
            // ç»‘å®šåˆ†é¡µäº‹ä»¶
            document.getElementById('prevPage')?.addEventListener('click', () => {
                if (TABLE_CONFIG.currentPage > 1) {
                    TABLE_CONFIG.currentPage--;
                    renderTable();
                    updateCharts();
                }
            });
            
            document.getElementById('nextPage')?.addEventListener('click', () => {
                if (TABLE_CONFIG.currentPage < totalPages) {
                    TABLE_CONFIG.currentPage++;
                    renderTable();
                    updateCharts();
                }
            });
            
            document.querySelectorAll('.pagination-btn[data-page]').forEach(btn => {
                btn.addEventListener('click', () => {
                    TABLE_CONFIG.currentPage = parseInt(btn.dataset.page);
                    renderTable();
                    updateCharts();
                });
            });
        }
        
        // æ’åºæ•°æ®
        function sortData(data, field, direction) {
            return [...data].sort((a, b) => {
                let aVal = a[field];
                let bVal = b[field];
                
                // å¤„ç†å­—ç¬¦ä¸²æ¯”è¾ƒ
                if (typeof aVal === 'string') {
                    aVal = aVal.toLowerCase();
                    bVal = bVal.toLowerCase();
                }
                
                if (aVal < bVal) return direction === 'asc' ? -1 : 1;
                if (aVal > bVal) return direction === 'asc' ? 1 : -1;
                return 0;
            });
        }
        
        // ç­›é€‰æ•°æ®
        function filterData(data, type, search) {
            let filtered = [...data];
            
            // æŒ‰ç±»å‹ç­›é€‰
            if (type === 'teachers') {
                filtered = filtered.filter(item => item.type === 'teacher');
            } else if (type === 'students') {
                filtered = filtered.filter(item => item.type === 'student');
            }
            
            // æŒ‰æœç´¢è¯ç­›é€‰
            if (search) {
                const searchLower = search.toLowerCase();
                filtered = filtered.filter(item => 
                    item.name.toLowerCase().includes(searchLower) ||
                    item.id.toLowerCase().includes(searchLower) ||
                    item.displayName.toLowerCase().includes(searchLower) ||
                    item.subject.toLowerCase().includes(searchLower)
                );
            }
            
            return filtered;
        }
        
        // æ›´æ–°è¡¨æ ¼æ’åºæŒ‡ç¤ºå™¨
        function updateSortIndicators() {
            document.querySelectorAll('#statsTable th').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
                if (th.dataset.sort === currentSort.field) {
                    th.classList.add(`sort-${currentSort.direction}`);
                }
            });
        }
        
        // æ›´æ–°å›¾è¡¨
        function updateCharts() {
            renderLineChart(filteredData, currentFilter);
            renderPieChart(filteredData, currentFilter);
        }
        
        // å¯¼å‡ºæ•°æ®åˆ°Excel
        function exportToExcel() {
            // å‡†å¤‡å¯¼å‡ºæ•°æ®
            const exportData = filteredData.map(item => ({
                'ç¼–å·/åº§å·': item.id,
                'å§“å': currentFilter === 'teachers' ? `${item.subject}-${item.name}` : 
                       currentFilter === 'students' ? `${item.id}-${item.name}` : item.name,
                'ç±»å‹': item.type === 'teacher' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ',
                'ç§‘ç›®/ç­çº§': item.subject,
                'è¯­å½•æ•°é‡': item.quoteCount,
                'è¢«æåŠæ¬¡æ•°': item.mentionedCount,
                'å½±å“åŠ›æŒ‡æ•°': item.influenceScore.toFixed(1)
            }));
            
            // åˆ›å»ºå·¥ä½œè¡¨
            const ws = XLSX.utils.json_to_sheet(exportData);
            
            // åˆ›å»ºå·¥ä½œç°¿
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ç»Ÿè®¡æ•°æ®');
            
            // æ·»åŠ å…ƒæ•°æ®
            const metadata = [
                ['ä¸–è¯´é‡‘è¯­ - ç»Ÿè®¡æ•°æ®å¯¼å‡º'],
                [`å¯¼å‡ºæ—¶é—´: ${new Date().toLocaleString('zh-CN')}`],
                [`è¯­å½•æ”¶å½•æˆªæ­¢: ${UPDATE_TIME}`],
                [`æ•°æ®ç±»å‹: ${currentFilter === 'all' ? 'å…¨éƒ¨' : currentFilter === 'teachers' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ'}`],
                [`æ€»è®°å½•æ•°: ${exportData.length}`],
                [],
                ['è¯´æ˜: å½±å“åŠ›æŒ‡æ•° = è¯­å½•æ•°é‡ Ã— 1.0 + è¢«æåŠæ¬¡æ•° Ã— 0.7']
            ];
            
            const metaWs = XLSX.utils.aoa_to_sheet(metadata);
            XLSX.utils.book_append_sheet(wb, metaWs, 'è¯´æ˜');
            
            // ä¿å­˜æ–‡ä»¶
            const filename = `ä¸–è¯´é‡‘è¯­ç»Ÿè®¡_${currentFilter}_${new Date().toISOString().slice(0,10)}.xlsx`;
            XLSX.writeFile(wb, filename);
        }
        
        // ============================================
        // é¡µé¢åˆå§‹åŒ–
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // æ›´æ–°é¡µé¢ä¸Šçš„æ—¶é—´æ˜¾ç¤º
            document.getElementById('updateTimeDisplay').textContent = UPDATE_TIME;
            
            // ç”Ÿæˆæ•°æ®
            allStatsData = generateStatsData();
            
            // åˆå§‹åŒ–æ•°æ®ç­›é€‰
            filteredData = filterData(allStatsData, currentFilter, currentSearch);
            filteredData = sortData(filteredData, currentSort.field, currentSort.direction);
            
            // æ¸²æŸ“æ‰€æœ‰ç»„ä»¶
            renderStatsSummary(filteredData);
            updateCharts();
            renderTable();
            updateSortIndicators();
            
            // ============================================
            // äº‹ä»¶ç»‘å®š
            // ============================================
            
            // ç­›é€‰æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // æ›´æ–°ç­›é€‰ç±»å‹
                    currentFilter = this.dataset.type;
                    
                    // é‡ç½®åˆ†é¡µ
                    TABLE_CONFIG.currentPage = 1;
                    
                    // é‡æ–°ç­›é€‰å’Œæ’åºæ•°æ®
                    filteredData = filterData(allStatsData, currentFilter, currentSearch);
                    filteredData = sortData(filteredData, currentSort.field, currentSort.direction);
                    
                    // é‡æ–°æ¸²æŸ“
                    renderStatsSummary(filteredData);
                    updateCharts();
                    renderTable();
                });
            });
            
            // è¡¨æ ¼æ’åºäº‹ä»¶
            document.querySelectorAll('#statsTable th[data-sort]').forEach(th => {
                th.addEventListener('click', function() {
                    const field = this.dataset.sort;
                    
                    // å¦‚æœç‚¹å‡»çš„æ˜¯å½“å‰æ’åºå­—æ®µï¼Œåˆ™åˆ‡æ¢æ’åºæ–¹å‘
                    if (currentSort.field === field) {
                        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                    } else {
                        // å¦åˆ™è®¾ç½®ä¸ºæ–°çš„æ’åºå­—æ®µï¼Œé»˜è®¤é™åº
                        currentSort.field = field;
                        currentSort.direction = 'desc';
                    }
                    
                    // æ’åºæ•°æ®
                    filteredData = sortData(filteredData, currentSort.field, currentSort.direction);
                    
                    // æ›´æ–°UI
                    updateSortIndicators();
                    renderTable();
                });
            });
            
            // æœç´¢æ¡†è¾“å…¥äº‹ä»¶
            document.getElementById('searchInput').addEventListener('input', function(e) {
                currentSearch = e.target.value;
                
                // é‡ç½®åˆ†é¡µ
                TABLE_CONFIG.currentPage = 1;
                
                // é‡æ–°ç­›é€‰å’Œæ’åºæ•°æ®
                filteredData = filterData(allStatsData, currentFilter, currentSearch);
                filteredData = sortData(filteredData, currentSort.field, currentSort.direction);
                
                // é‡æ–°æ¸²æŸ“
                renderStatsSummary(filteredData);
                renderTable();
                
                // å¦‚æœæ•°æ®ä¸ºç©ºï¼Œæ˜¾ç¤ºæç¤º
                if (filteredData.length === 0 && currentSearch) {
                    const tbody = document.getElementById('tableBody');
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #666;">
                                <div style="font-size: 48px; margin-bottom: 10px;">ğŸ”</div>
                                <div>æœªæ‰¾åˆ°ä¸"${currentSearch}"ç›¸å…³çš„è®°å½•</div>
                            </td>
                        </tr>
                    `;
                    document.getElementById('pagination').innerHTML = '';
                }
            });
            
            // å¯¼å‡ºæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('exportBtn').addEventListener('click', exportToExcel);
            
            // ============================================
            // ä¾§è¾¹æ åŠŸèƒ½
            // ============================================
            
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const mainContent = document.getElementById('main-content');
            let sidebarCollapsed = false;

            sidebarToggle.addEventListener('click', () => {
                sidebarCollapsed = !sidebarCollapsed;
                if (sidebarCollapsed) {
                    sidebar.classList.add('collapsed');
                    mainContent.classList.add('sidebar-collapsed');
                    sidebarToggle.textContent = 'â˜°';
                } else {
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('sidebar-collapsed');
                    sidebarToggle.textContent = 'â‰¡';
                }
            });
            
            // ä¾§è¾¹æ å¯¼èˆªé¡¹ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.teacher-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // å¦‚æœæ˜¯é“¾æ¥ï¼Œå…è®¸è·³è½¬
                    if (this.hasAttribute('href')) {
                        return;
                    }
                    e.preventDefault();
                    // å¦‚æœæ˜¯è¯­å½•é¡¹ï¼Œè·³å›ä¸»é¡µ
                    window.location.href = 'index.html';
                });
            });
            
            // ============================================
            // å›åˆ°é¡¶éƒ¨åŠŸèƒ½
            // ============================================
            
            const backToTopBtn = document.getElementById('back-to-top');
            
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = 'block';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });

            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // åˆå§‹éšè—å›åˆ°é¡¶éƒ¨æŒ‰é’®
            backToTopBtn.style.display = 'none';
        });
    </script>
</body>
</html>
